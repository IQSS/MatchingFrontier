<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examining the Propensity Score Matching Paradox • MatchingFrontier</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examining the Propensity Score Matching Paradox">
<meta property="og:description" content="MatchingFrontier">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchingFrontier</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/MatchingFrontier.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/psm-paradox.html">Examining the Propensity Score Matching Paradox</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IQSS/MatchingFrontier/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="psm-paradox_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examining the Propensity Score Matching Paradox</h1>
                        <h4 data-toc-skip class="author">Noah Greifer</h4>
            
            <h4 data-toc-skip class="date">2022-09-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IQSS/MatchingFrontier/blob/HEAD/vignettes/psm-paradox.Rmd" class="external-link"><code>vignettes/psm-paradox.Rmd</code></a></small>
      <div class="hidden name"><code>psm-paradox.Rmd</code></div>

    </div>

    
    
<style>
pre {
  overflow-x: auto;
}
pre code {
  word-wrap: normal;
  white-space: pre;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The propensity score matching (PSM) paradox is feature of PSM highlighted in <span class="citation">King and Nielsen (<a href="#ref-king2019" role="doc-biblioref">2019</a>)</span> “Why Propensity Scores Should Not Be Used for Matching” that serves as one of the reasons the authors warn against using PSM to balance covariates and estimate causal effects. The paradox is described in <span class="citation">King and Nielsen (<a href="#ref-king2019" role="doc-biblioref">2019</a>)</span> (hereafter KN19) as follows:</p>
<blockquote>
<p>…[A]fter PSM’s goal of complete randomization has been approximated […], pruning the observations with the worst matched observations, according to the absolute propensity score distance in treated and control pairs, will increase imbalance, model dependence, and bias; this will also be true when pruning the pair with the next largest distance, and so on.</p>
</blockquote>
<p>The reason this is so pernicious is that the point of PSM is to decrease imbalance, and applying a caliper to the propensity score to ensure matches are close can have the opposite effect of making balance worse. That is, by restricting the matches so that only the closest pairs remain, balance can be worse than were the far apart pairs to remain. This is a feature other matching methods do not share with PSM (at least not to the same degree), which is why KN19 argue PSM is suboptimal and other methods, like Mahalanobis distance matching or coarsened exact matching, should be used instead.</p>
</div>
<div class="section level2">
<h2 id="the-psm-paradox-and-matchingfrontier">The PSM Paradox and <code>MatchingFrontier</code><a class="anchor" aria-label="anchor" href="#the-psm-paradox-and-matchingfrontier"></a>
</h2>
<p>KN19’s analysis of the PSM paradox in real and simulated datasets involved performing a propensity score match, pruning the most distant pairs one-by-one (i.e., imposing a stricter and stricter caliper), and measuring balance at each point. In this way, studying the PSM paradox is similar to creating a matching frontier, which also involves dropping units one-by-one starting with the most distant units. Given this similarity, as of version 4.1.0, <code>MatchingFrontier</code> includes tools to analyze the PSM paradox in supplied data using some of the same technology used to create and examine a matching frontier. We demonstrate these methods below.</p>
<p>The procedure to study the PSM paradox proceeds in the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Perform PSM using <code><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html" class="external-link">MatchIt::matchit()</a></code></p></li>
<li><p>Create a balance-sample size “frontier” using <code><a href="../reference/makeFrontier.html">makeFrontier()</a></code></p></li>
<li><p>Examine model dependence using <code><a href="../reference/estimateEffects.html">estimateEffects()</a></code></p></li>
</ol>
<p>We will use the <code>finkel2012</code> dataset in <code>MatchingFrontier</code> to study the PSM. See <code><a href="../reference/finkel2012.html">help("finkel2012", package = "MatchingFrontier")</a></code> for more information. This dataset comes from <span class="citation">Finkel, Horowitz, and Rojo-Mendoza (<a href="#ref-finkelCivicEducationDemocratic2012" role="doc-biblioref">2012</a>)</span> and was used in KN19 to study the PSM paradox. The important points are that the treatment is <code>treat</code>, the outcome is <code>polknow</code>, and the other variables are covariates. No specific estimand or quantity of interest was specified as the target estimand in the original study; because the analysis presented below and used in <span class="citation">Finkel, Horowitz, and Rojo-Mendoza (<a href="#ref-finkelCivicEducationDemocratic2012" role="doc-biblioref">2012</a>)</span> involves discarding treated units, the feasible SATT (FSATT) becomes the target of inference.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://projects.iq.harvard.edu/frontier" class="external-link">MatchingFrontier</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"finkel2012"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">finkel2012</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   treat uraiamedia age churchgo groupactive income groupleader male educ   religion media polinterest poldiscuss civicgroup polparty polknow</span></span>
<span><span class="co">## 1     1          1  38        4   1.0000000      4           1    1    8   catholic  3.25         3.0          2          2        2       4</span></span>
<span><span class="co">## 2     1          1  55        5   0.7272727      3           1    1    3 protestant  4.00         2.5          2          0        1       3</span></span>
<span><span class="co">## 3     1          1  38        4   1.4545455      2           1    0    5   catholic  3.50         3.0          2          2        2       2</span></span>
<span><span class="co">## 4     1          1  35        4   0.2727273      4           0    0    5 protestant  3.00         1.0          2          0        0       3</span></span>
<span><span class="co">## 5     1          1  30        3   0.1818182      4           0    1    6 protestant  3.00         3.0          2          0        0       4</span></span>
<span><span class="co">## 6     1          1  32        4   0.3636364      4           0    1    5 protestant  3.25         2.5          2          0        0       4</span></span></code></pre>
<p>First, we’ll use <code><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html" class="external-link">MatchIt::matchit()</a></code> to perform propensity score matching. This analysis can only be done using <code>MatchingFrontier</code> after 1:1 matching with or without replacement. This matching does not have to involve a propensity score, but because we are investigating the PSM paradox, we perform 1:1 PSM (here, without replacement, as is most common).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treat_formula</span> <span class="op">&lt;-</span> <span class="va">treat</span> <span class="op">~</span> <span class="va">uraiamedia</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">churchgo</span> <span class="op">+</span></span>
<span>  <span class="va">groupactive</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span>  <span class="va">groupleader</span> <span class="op">+</span> <span class="va">male</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span></span>
<span>  <span class="va">religion</span> <span class="op">+</span> <span class="va">media</span> <span class="op">+</span> <span class="va">polinterest</span> <span class="op">+</span> <span class="va">poldiscuss</span> <span class="op">+</span></span>
<span>  <span class="va">civicgroup</span> <span class="op">+</span> <span class="va">polparty</span></span>
<span></span>
<span><span class="co"># 1:1 PS matching w/o replacement using a logistic regression</span></span>
<span><span class="co"># propensity score</span></span>
<span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu">MatchIt</span><span class="fu">::</span><span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html" class="external-link">matchit</a></span><span class="op">(</span><span class="va">treat_formula</span>, data <span class="op">=</span> <span class="va">finkel2012</span>,</span>
<span>                          method <span class="op">=</span> <span class="st">"nearest"</span><span class="op">)</span></span>
<span><span class="va">m.out</span></span></code></pre></div>
<pre><code><span><span class="co">## A matchit object</span></span>
<span><span class="co">##  - method: 1:1 nearest neighbor matching without replacement</span></span>
<span><span class="co">##  - distance: Propensity score</span></span>
<span><span class="co">##              - estimated with logistic regression</span></span>
<span><span class="co">##  - number of obs.: 3141 (original), 2694 (matched)</span></span>
<span><span class="co">##  - target estimand: ATT</span></span>
<span><span class="co">##  - covariates: uraiamedia, age, churchgo, groupactive, income, groupleader, male, educ, religion, media, polinterest, poldiscuss, civicgroup, polparty</span></span></code></pre>
<p>We can examine balance on the original matched sample using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## MatchIt::matchit(formula = treat_formula, data = finkel2012, </span></span>
<span><span class="co">##     method = "nearest")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Balance for All Data:</span></span>
<span><span class="co">##                    Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max</span></span>
<span><span class="co">## distance                  0.4576        0.4073          0.4516     1.1130    0.1295   0.2047</span></span>
<span><span class="co">## uraiamedia                0.5872        0.4103          0.3595          .    0.1770   0.1770</span></span>
<span><span class="co">## age                      34.5271       33.5318          0.0867     1.0678    0.0162   0.0516</span></span>
<span><span class="co">## churchgo                  4.1811        4.1249          0.0619     1.0038    0.0113   0.0425</span></span>
<span><span class="co">## groupactive               0.4554        0.4349          0.0749     1.1905    0.0126   0.0473</span></span>
<span><span class="co">## income                    2.0082        1.9091          0.1107     1.1119    0.0248   0.0509</span></span>
<span><span class="co">## groupleader               0.3890        0.2954          0.1920          .    0.0936   0.0936</span></span>
<span><span class="co">## male                      0.5947        0.6003         -0.0116          .    0.0057   0.0057</span></span>
<span><span class="co">## educ                      4.1700        4.1817         -0.0060     1.0049    0.0083   0.0163</span></span>
<span><span class="co">## religionprotestant        0.5330        0.5468         -0.0276          .    0.0138   0.0138</span></span>
<span><span class="co">## religioncatholic          0.2353        0.2196          0.0370          .    0.0157   0.0157</span></span>
<span><span class="co">## religionmuslim            0.2071        0.2152         -0.0198          .    0.0080   0.0080</span></span>
<span><span class="co">## religionother             0.0245        0.0184          0.0395          .    0.0061   0.0061</span></span>
<span><span class="co">## media                     2.4333        2.3772          0.0879     1.0040    0.0192   0.0572</span></span>
<span><span class="co">## polinterest               2.4840        2.4443          0.0731     0.9748    0.0162   0.0345</span></span>
<span><span class="co">## poldiscuss                1.6318        1.5446          0.1298     0.8333    0.0291   0.0497</span></span>
<span><span class="co">## civicgroup                0.2665        0.1940          0.1159     1.3706    0.0242   0.0392</span></span>
<span><span class="co">## polparty                  0.3244        0.3049          0.0297     1.1095    0.0065   0.0177</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Summary of Balance for Matched Data:</span></span>
<span><span class="co">##                    Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max Std. Pair Dist.</span></span>
<span><span class="co">## distance                  0.4576        0.4398          0.1595     1.2410    0.0409   0.1054          0.1597</span></span>
<span><span class="co">## uraiamedia                0.5872        0.5397          0.0965          .    0.0475   0.0475          0.3800</span></span>
<span><span class="co">## age                      34.5271       33.8396          0.0599     1.0839    0.0112   0.0364          1.0348</span></span>
<span><span class="co">## churchgo                  4.1811        4.1529          0.0310     1.0463    0.0077   0.0304          0.9026</span></span>
<span><span class="co">## groupactive               0.4554        0.4441          0.0414     1.1754    0.0089   0.0297          1.0612</span></span>
<span><span class="co">## income                    2.0082        1.9636          0.0498     1.0423    0.0111   0.0290          0.9595</span></span>
<span><span class="co">## groupleader               0.3890        0.3460          0.0883          .    0.0431   0.0431          0.7614</span></span>
<span><span class="co">## male                      0.5947        0.5932          0.0030          .    0.0015   0.0015          0.9375</span></span>
<span><span class="co">## educ                      4.1700        4.1849         -0.0077     1.0114    0.0064   0.0148          1.1277</span></span>
<span><span class="co">## religionprotestant        0.5330        0.5405         -0.0149          .    0.0074   0.0074          0.9732</span></span>
<span><span class="co">## religioncatholic          0.2353        0.2331          0.0053          .    0.0022   0.0022          0.8243</span></span>
<span><span class="co">## religionmuslim            0.2071        0.2027          0.0110          .    0.0045   0.0045          0.7877</span></span>
<span><span class="co">## religionother             0.0245        0.0238          0.0048          .    0.0007   0.0007          0.3121</span></span>
<span><span class="co">## media                     2.4333        2.4214          0.0186     1.0018    0.0075   0.0341          1.1137</span></span>
<span><span class="co">## polinterest               2.4840        2.4692          0.0273     0.9899    0.0068   0.0119          1.0657</span></span>
<span><span class="co">## poldiscuss                1.6318        1.6088          0.0343     0.9478    0.0077   0.0134          0.8167</span></span>
<span><span class="co">## civicgroup                0.2665        0.2175          0.0783     1.2227    0.0163   0.0260          0.6239</span></span>
<span><span class="co">## polparty                  0.3244        0.3192          0.0079     1.0907    0.0097   0.0171          0.8019</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Sample Sizes:</span></span>
<span><span class="co">##           Control Treated</span></span>
<span><span class="co">## All          1794    1347</span></span>
<span><span class="co">## Matched      1347    1347</span></span>
<span><span class="co">## Unmatched     447       0</span></span>
<span><span class="co">## Discarded       0       0</span></span></code></pre>
<p>Of note is that the sample prior to matching was well balanced already, meaning there is little advantage to discarding units by matching, and making this dataset ripe for the PSM paradox. By examining what happens when additional units are dropped, we can see the paradox in action. To do so, we call <code><a href="../reference/makeFrontier.html">makeFrontier()</a></code>, supplying a balance metric to use to track balance as additional units are dropped (in this case, the energy distance <span class="citation">(Rizzo and Székely <a href="#ref-rizzo2016" role="doc-biblioref">2016</a>)</span>)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a "frontier" by dropping the most distant pairs</span></span>
<span><span class="va">f.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeFrontier.html">makeFrontier</a></span><span class="op">(</span><span class="va">m.out</span>, metric <span class="op">=</span> <span class="st">"energy"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">f.out</span></span></code></pre></div>
<pre><code><span><span class="co">## A matchFrontier object</span></span>
<span><span class="co">## - quantity of interest: FSATT</span></span>
<span><span class="co">## - imbalance metric: energy distance</span></span>
<span><span class="co">## - treatment: treat</span></span>
<span><span class="co">## - covariates: uraiamedia, age, churchgo, groupactive, income, groupleader, male, educ, religion, media, polinterest, poldiscuss, civicgroup, polparty</span></span>
<span><span class="co">## - number of points: 1338</span></span></code></pre>
<p>We can now plot the relationship between the number of units dropped and the resulting balance using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. (We zoom in on a part of the plot using <code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">ggplot2::coord_cartesian()</a></code>.)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f.out</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1250</span><span class="op">)</span>,</span>
<span>                                       ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="psm-paradox_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>As more units are dropped, leaving only units that are the most closely matched on the propensity score, balance worsens, whereas one would naively expect balance to improve because the remaining units have closer values of the propensity score; this is the PSM paradox.</p>
<p>We can also examine model dependence as additional units are dropped. The PSM paradox suggests that model dependence should increase as additional units are dropped, again, in contrast to the expectation that with only the most similar units remaining, the treatment effect estimate would depend less on the specific model used. We can use <code><a href="../reference/estimateEffects.html">estimateEffects()</a></code> to estimate treatment effects for each sample. We’ll request the “extreme bounds” procedure to examine model dependence; this produces bounds representing the largest and smallest effect estimates across many different randomly selected model specifications that include some covariates and powers of them and omit others.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">97531</span><span class="op">)</span></span>
<span><span class="va">e.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateEffects.html">estimateEffects</a></span><span class="op">(</span><span class="va">f.out</span>, outcome <span class="op">=</span> <span class="st">"polknow"</span>,</span>
<span>                         Ndrop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1250</span><span class="op">)</span>,</span>
<span>                         method <span class="op">=</span> <span class="st">"extreme-bounds"</span>,</span>
<span>                         verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">e.out</span></span></code></pre></div>
<pre><code><span><span class="co">## A frontierEstimates object</span></span>
<span><span class="co">## - quantity of interest: FSATT</span></span>
<span><span class="co">## - model sensitivity method: extreme bounds</span></span>
<span><span class="co">##    - number of specifications: 100</span></span>
<span><span class="co">## - number of estimates: 250</span></span>
<span><span class="co">## - treatment: treat</span></span>
<span><span class="co">## - covariates: uraiamedia, age, churchgo, groupactive, income, groupleader, male, educ, religion, media, polinterest, poldiscuss, civicgroup, polparty</span></span>
<span><span class="co">## - outcome model: polknow ~ treat</span></span></code></pre>
<p>Rather than plot the estimates themselves, we can plot the width of the model dependence bands as a measure of model dependence. The code below does this using <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute the difference between the model dependence bounds</span></span>
<span><span class="va">widths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">e.out</span><span class="op">$</span><span class="va">mod.dependence</span>, <span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the differences against the number of units dropped</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">e.out</span><span class="op">$</span><span class="va">Xs</span>, y <span class="op">=</span> <span class="va">widths</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Number of treated units dropped"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Model dependence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="psm-paradox_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>As additional pairs of units are dropped, model dependence increases, in opposition to the purpose of matching, which is to decrease model dependence <span class="citation">(Ho et al. <a href="#ref-hoMatchingNonparametricPreprocessing2007" role="doc-biblioref">2007</a>)</span>. This is a consequence of the PSM paradox and a reason KN19 urge researchers to be cautious when using PSM.</p>
</div>
<div class="section level2">
<h2 id="implications-of-the-psm-paradox">Implications of the PSM Paradox<a class="anchor" aria-label="anchor" href="#implications-of-the-psm-paradox"></a>
</h2>
<p>While the presence of the PSM paradox doesn’t necessarily mean one should automatically abandon PSM as a method of adjusting for confounding, it does suggest that care needs to be taken when using PSM to ensure imbalance and model dependence are not worse after matching than they are before matching. One also should be cautious about using a caliper, especially without first examining balance in a match without one. Although using calipers can improve the balancing and bias-reduction abilities of PSM <span class="citation">(Austin <a href="#ref-austinComparison12Algorithms2014" role="doc-biblioref">2014</a>)</span>, blindly using a caliper without assessing balance can engage the PSM paradox, making results less robust.</p>
<p>The PSM paradox also suggests that other methods that rely less on the propensity score might be tried instead. Mahalanobis distance matching, coarsened exact matching, cardinality matching, and genetic matching, which operate on the covariates directly without a propensity score, may perform well in some datasets and are less susceptible to the paradox (though they are not immune as described in the appendix of KN19); these methods are all available in <code>MatchIt</code>. An alternative is to manage the balance/sample size directly using the matching frontier in such a way as to optimize balance at each sample size, as described in <span class="citation">King, Lucas, and Nielsen (<a href="#ref-king2017" role="doc-biblioref">2017</a>)</span> and the <code>MatchingFrontier</code> vignette (<code><a href="../articles/MatchingFrontier.html">vignette("MatchingFrontier")</a></code>), using functions in this package.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-austinComparison12Algorithms2014">
<p>Austin, Peter C. 2014. “A Comparison of 12 Algorithms for Matching on the Propensity Score.” <em>Statistics in Medicine</em> 33 (6): 1057–69. <a href="https://doi.org/10.1002/sim.6004" class="external-link">https://doi.org/10.1002/sim.6004</a>.</p>
</div>
<div id="ref-finkelCivicEducationDemocratic2012">
<p>Finkel, Steven E., Jeremy Horowitz, and Reynaldo T. Rojo-Mendoza. 2012. “Civic Education and Democratic Backsliding in the Wake of Kenya’s Post-2007 Election Violence.” <em>The Journal of Politics</em>, January. <a href="https://doi.org/10.1017/S0022381611001162" class="external-link">https://doi.org/10.1017/S0022381611001162</a>.</p>
</div>
<div id="ref-hoMatchingNonparametricPreprocessing2007">
<p>Ho, Daniel E., Kosuke Imai, Gary King, and Elizabeth A. Stuart. 2007. “Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inference.” <em>Political Analysis</em> 15 (3): 199–236. <a href="https://doi.org/10.1093/pan/mpl013" class="external-link">https://doi.org/10.1093/pan/mpl013</a>.</p>
</div>
<div id="ref-king2017">
<p>King, Gary, Christopher Lucas, and Richard A. Nielsen. 2017. “The Balance-Sample Size Frontier in Matching Methods for Causal Inference.” <em>American Journal of Political Science</em> 61 (2): 473–89. <a href="https://doi.org/10.1111/ajps.12272" class="external-link">https://doi.org/10.1111/ajps.12272</a>.</p>
</div>
<div id="ref-king2019">
<p>King, Gary, and Richard Nielsen. 2019. “Why Propensity Scores Should Not Be Used for Matching.” <em>Political Analysis</em>, May, 1–20. <a href="https://doi.org/10.1017/pan.2019.11" class="external-link">https://doi.org/10.1017/pan.2019.11</a>.</p>
</div>
<div id="ref-rizzo2016">
<p>Rizzo, Maria L., and Gábor J. Székely. 2016. “Energy Distance.” <em>WIREs Computational Statistics</em> 8 (1): 27–38. <a href="https://doi.org/https://doi.org/10.1002/wics.1375" class="external-link">https://doi.org/https://doi.org/10.1002/wics.1375</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>To be precise, this is not really a frontier in that it does not represent the best balance possible for the given sample size; rather, it represents the balance corresponding to a sample with the closest pairs for a given sample size, conditional on having already formed the pairs. <code><a href="../reference/makeFrontier.html">makeFrontier()</a></code> is used here because it relies on the same technology used for making a true frontier, i.e., dropping units in a specific order and computing a global measure of balance for each sample of remaining units.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gary King, Christopher Lucas, Richard Nielsen, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
