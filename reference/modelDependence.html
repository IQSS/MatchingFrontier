<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute Model Dependence Bounds — modelDependence • MatchingFrontier</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute Model Dependence Bounds — modelDependence" />
<meta property="og:description" content="modelDependence() computes model dependence bounds for a single dataset using either the extreme bounds procedure or Athey-Imbens procedure. The width of the bounds indicates the degree of model dependence present in the dataset. Wide bounds imply that treatment effects could vary greatly depending on the outcome model used and therefore depend heavily on it." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchingFrontier</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MatchingFrontier.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Model Dependence Bounds</h1>
    
    <div class="hidden name"><code>modelDependence.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>modelDependence()</code> computes model dependence bounds for a single dataset using either the extreme bounds procedure or Athey-Imbens procedure. The width of the bounds indicates the degree of model dependence present in the dataset. Wide bounds imply that treatment effects could vary greatly depending on the outcome model used and therefore depend heavily on it.</p>
    </div>

    <pre class="usage"><span class='fu'>modelDependence</span><span class='op'>(</span>base.form <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>dataset</span>, <span class='va'>treatment</span>,
                <span class='va'>outcome</span>, <span class='va'>covariates</span>, weights <span class='op'>=</span> <span class='cn'>NULL</span>,
                method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"extreme-bounds"</span>, <span class='st'>"athey-imbens"</span><span class='op'>)</span>,
                model.dependence.ests <span class='op'>=</span> <span class='fl'>101</span>,
                specifications <span class='op'>=</span> <span class='cn'>NULL</span>, cutpoints <span class='op'>=</span> <span class='cn'>NULL</span>,
                cutpoint.method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mean"</span>, <span class='st'>"median"</span>, <span class='st'>"segmented"</span><span class='op'>)</span>,
                verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, seed <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='co'># S3 method for modelDependenceBounds</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for modelDependenceBounds</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>base.form</th>
      <td><p>a <code><a href='https://rdrr.io/r/stats/formula.html'>formula</a></code> relating the outcome to the treatment and covariates, e.g., <code>Y ~ A + X1 + X2 + ...</code> where <code>Y</code> represents the outcome variable, <code>A</code> the treatment variable, and <code>X1</code> and <code>X2</code> the covariates. This should correspond to the "default" or originally intended outcome model whose sensitivity is being assessed. If omitted, will just use a simple regression of the outcome on the treatment.</p></td>
    </tr>
    <tr>
      <th>dataset</th>
      <td><p>a data frame containing the variables named in <code>base.form</code>, <code>treatment</code>, <code>outcome</code>, and <code>covariates</code>.</p></td>
    </tr>
    <tr>
      <th>treatment</th>
      <td><p>the name of the treatment variable. If missing and <code>base.form</code> is specified and only has one right-hand side variable, that variable will be considered the treatment.</p></td>
    </tr>
    <tr>
      <th>outcome</th>
      <td><p>the name of the outcome variable. Ignored if <code>base.form</code> is supplied and required otherwise.</p></td>
    </tr>
    <tr>
      <th>covariates</th>
      <td><p>a character vector containing the names of the covariates over which model dependence is to be assessed. Can also be a one-sided formula with the covariates on the right-hand side. If omitted, all variables in <code>base.form</code> that are not the treatment or outcome will be considered covariates.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>an optional vector of weights (e.g., matching weights) to be included in the fitted models.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>the method of computing model dependence bounds. Can be one of <code>"extreme-bounds"</code> or <code>"athey-imbens"</code> for the extreme bounds or Athey-Imbens procedures, respectively. Abbreviations allowed. Default is extreme bounds. See Details.</p></td>
    </tr>
    <tr>
      <th>model.dependence.ests</th>
      <td><p>when <code>method = "extreme-bounds"</code>, the number of different model specifications to use. Higher numbers give more accurate bounds but take longer. Exactly one of <code>model.dependence.ests</code> or <code>specifications</code> must be supplied.</p></td>
    </tr>
    <tr>
      <th>specifications</th>
      <td><p>when <code>method = "extreme-bounds"</code>, a list of <code>formula</code>s containing all the model specifications to consider in computing the extreme bounds. If omitted, these will be randomly generated using up to third degree polynomials and two-way interactions between covariates. Exactly one of <code>model.dependence.ests</code> or <code>specifications</code> must be supplied.</p></td>
    </tr>
    <tr>
      <th>cutpoints</th>
      <td><p>when <code>method = "athey-imbens"</code>, a named list of the cutpoints for each covariate that has more than two unique values. A cutpoint of <code>NA</code> means the unique values of the variable will be used. For any covariates without cutpoints specified, the cutpoints will computed using the method supplied to <code>cutpoint.method</code>.</p></td>
    </tr>
    <tr>
      <th>cutpoint.method</th>
      <td><p>when <code>method = "athey-imbens"</code>, the name of the method to create cutpoints for covariates without entries in <code>cutpoints</code>. Options include <code>"mean"</code> (the default) to use the covariate mean as the cutpoint, <code>"median"</code> to use the covariate median as the cutpoint, and <code>"segmented"</code> to estimate the cutpoints with segmented (piecewise) regression. Abbreviations allowed.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code>; whether to print additional information about the procedure.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>the seed for the random number generator. If <code>NULL</code>, the current <a href='https://rdrr.io/r/base/Random.html'>seed</a> is used.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>a <code>modelDependenceBounds</code> object, the output of a call to <code>modelDependence()</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>for <code>print.modelDependenceBounds</code>, further arguments passed to <code><a href='https://rdrr.io/r/base/print.html'>print()</a></code>. Ignored otherwise.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The simplest way to estimate the model dependence bounds is to supply <code>base.form</code> with the treatment and covariates on the right hand side and <code>treatment</code> supplied.</p>
<p>The extreme bounds procedure (Leamer, 1983) works by fitting many different models of various functional forms with many combinations of the covariates. When <code>specifications</code> is not supplied, these models are randomly generated by appending to the model in <code>base.form</code> sets of squares, cubes, and two-way interactions of the covariates with <code>model.dependence.ests</code> controlling how many such models are estimated. More is always better but will take longer. The 2.5th and 97.5th percentiles of the treatment effects from all the specifications are used as the model dependence bounds.</p>
<p>The Athey-Imbens procedure (Athey &amp; Imbens, 2015) works by splitting covariates at points determined by <code>cutpoints</code> or <code>cutpoint.method</code>, fitting the <code>base.form</code> model within each subset, averaging the two effect estimates, and computing the standard deviation of the resulting effect estimates. The base treatment effect estimate (fit in the full sample) minus and plus this standard deviation are used as the model dependence bounds. <code>cutpoints</code> can be supplied or estimated for each covariate. For covariates with exactly two unique values, the data will be split according to those values. For covariates with more than two values, if a cutpoint is supplied, it will be used to split the dataset; otherwise, a cutpoint will be estimated as the mean or median of the covariate or using segmented regression as implemented in <code><a href='https://rdrr.io/pkg/segmented/man/segmented.html'>segmented::segmented()</a></code> depending on the argument to <code>cutpoint.method</code>.</p>
<p>It is important to consider the interpretation of <code>base.form</code>. If there is no confounding by the covariates (e.g., because of the result of a randomized experiment or successful matching), <code>base.form</code> can specified simply as <code>Y ~ A</code>, with model dependence referring to all the possible adjustment sets and their functional forms. If there is confounding and <code>base.form</code> is specified as <code>Y ~ A</code> (or with only a subset of the confounding covariates included in the model), then model dependence concerns different adjustment sets, and therefore muddles dependence on model specification and covariate choice, which is undesirable. <code>base.form</code> should therefore contain all the covariates required to eliminate confounding, with the model dependence referring to the possible additional terms that could be added to the model to change its functional form. Put simply, the adjustment set should always be in <code>base.form</code>, but after randomization or successful matching the adjustment set might be empty.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>modelDependenceBounds</code> object, which is numeric vector with the lower and upper model dependence bounds and attributes concerning the fit. The attribute <code>"method"</code> will contain the method supplied to <code>method</code>. The attribute <code>base.est</code> will contain the effect estimated using <code>base.form</code> with no modification. The attribute <code>"estimates"</code> will contain the effect estimates used in computing the bounds. For the extreme bounds procedure, the attribute <code>"sepcifications"</code> contains a list of the model specifications used, each as a string representing the model formula. This can be supplied to future calls to <code>modelDependence()</code> or <code><a href='estimateEffects.html'>estimateEffects()</a></code>. For the Athey-Imbens procedure, the attribute <code>"sigma"</code> contains the standard deviation of the effect estimates that, when added to and subtracted from the estimate resulting from the model specified in <code>base.form</code>, forms the bounds.</p>
<p>The <code><a href='https://rdrr.io/r/base/print.html'>print()</a></code> method displays the bounds as well as their difference. Note that the difference is not actually stored in the <code>modelDependenceBounds</code> object but can be computed using <code><a href='https://rdrr.io/r/base/diff.html'>diff()</a></code>.</p>
<p>The <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot()</a></code> method displays a histogram of the effect estimates when <code>method = "extreme-bounds"</code> and a dot plot of the estimates when <code>method = "athey-imbens"</code>. Red vertical lines indicate the reported bounds, and the blue vertical line indicates the base estimate. The resulting object is a <code>ggplot</code> object that can be further manipulated using <span class="pkg">ggplot2</span> functionality.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Athey, S., &amp; Imbens, G. (2015). A measure of robustness to misspecification. <em>American Economic Review</em>, 105(5), 476-80.</p>
<p>Leamer, E. E. (1983). Let's take the con out of econometrics. <em>The American Economic Review</em>, 73(1), 31-43.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='estimateEffects.html'>estimateEffects()</a></code>, <a href='https://CRAN.R-project.org/package=ExtremeBounds'><span class="pkg">ExtremeBounds</span></a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://kosukeimai.github.io/MatchIt/'>MatchIt</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"lalonde"</span>, package <span class='op'>=</span> <span class='st'>"MatchIt"</span><span class='op'>)</span>

<span class='co'>#Model dependence prior to matching</span>
<span class='va'>b1</span> <span class='op'>&lt;-</span> <span class='fu'>modelDependence</span><span class='op'>(</span><span class='va'>re78</span> <span class='op'>~</span> <span class='va'>treat</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span>
                        <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>,
                      dataset <span class='op'>=</span> <span class='va'>lalonde</span>, treatment <span class='op'>=</span> <span class='st'>"treat"</span>,
                      method <span class='op'>=</span> <span class='st'>"extreme-bounds"</span>, seed <span class='op'>=</span> <span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>b1</span> <span class='co'># diff = 823.8418</span>
</div><div class='output co'>#&gt; Extreme model dependence bounds: 
#&gt;     lower     upper      diff 
#&gt;  858.8441 1682.6859  823.8418 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>b1</span><span class='op'>)</span>
</div><div class='img'><img src='modelDependence-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#Model dependence after matching</span>
<span class='va'>m.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://kosukeimai.github.io/MatchIt/reference/matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span> <span class='va'>race</span> <span class='op'>+</span>
                   <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                 distance <span class='op'>=</span> <span class='st'>"mahalanobis"</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>b2</span> <span class='op'>&lt;-</span> <span class='fu'>modelDependence</span><span class='op'>(</span><span class='va'>re78</span> <span class='op'>~</span> <span class='va'>treat</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span>
                        <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>,
                      dataset <span class='op'>=</span> <span class='va'>lalonde</span>, treatment <span class='op'>=</span> <span class='st'>"treat"</span>,
                      method <span class='op'>=</span> <span class='st'>"extreme-bounds"</span>, seed <span class='op'>=</span> <span class='fl'>12345</span>,
                      weights <span class='op'>=</span> <span class='va'>m.out</span><span class='op'>$</span><span class='va'>weights</span><span class='op'>)</span>
<span class='va'>b2</span> <span class='co'># diff = 684.6681</span>
</div><div class='output co'>#&gt; Extreme model dependence bounds: 
#&gt;     lower     upper      diff 
#&gt;  724.1218 1408.7899  684.6681 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>b2</span><span class='op'>)</span>
</div><div class='img'><img src='modelDependence-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#Athey-Imbens bounds using various cutpoints</span>
<span class='co'>#  Here we use cutpoints of 100 for re74 and re75 and split</span>
<span class='co'>#  other covariates at their means</span>
<span class='va'>b3</span> <span class='op'>&lt;-</span> <span class='fu'>modelDependence</span><span class='op'>(</span><span class='va'>re78</span> <span class='op'>~</span> <span class='va'>treat</span> <span class='op'>+</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>married</span> <span class='op'>+</span>
                        <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>,
                      dataset <span class='op'>=</span> <span class='va'>lalonde</span>, treatment <span class='op'>=</span> <span class='st'>"treat"</span>,
                      method <span class='op'>=</span> <span class='st'>"athey-imbens"</span>,
                      cutpoints <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>re74 <span class='op'>=</span> <span class='fl'>100</span>, re75 <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>,
                      cutpoint.method <span class='op'>=</span> <span class='st'>"mean"</span><span class='op'>)</span>
<span class='va'>b3</span>
</div><div class='output co'>#&gt; Athey-Imbens model dependence bounds: 
#&gt;    lower    upper     diff 
#&gt; 1043.574 2052.914 1009.340 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>b3</span><span class='op'>)</span>
</div><div class='img'><img src='modelDependence-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gary King, Christopher Lucas, Richard Nielsen, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


